class l extends HTMLElement{constructor(){super(),this.addEventListener("click",e=>{e.preventDefault(),(this.closest("cart-items")||this.closest("cart-drawer-items")).updateQuantity(this.dataset.index,0)})}}customElements.define("cart-remove-button",l);class g extends HTMLElement{constructor(){super(),this.lineItemStatusElement=document.getElementById("shopping-cart-line-item-status")||document.getElementById("CartDrawer-LineItemStatus"),this.currentItemCount=Array.from(this.querySelectorAll('[name="updates[]"]')).reduce((e,t)=>e+parseInt(t.value),0),this.debouncedOnChange=debounce(e=>{this.onChange(e)},300),this.addEventListener("change",this.debouncedOnChange.bind(this))}onChange(e){this.updateQuantity(e.target.dataset.index,e.target.value,document.activeElement.getAttribute("name"))}getSectionsToRender(){return[{id:"main-cart-items",section:document.getElementById("main-cart-items").dataset.id,selector:".js-contents"},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"cart-live-region-text",section:"cart-live-region-text",selector:".shopify-section"},{id:"main-cart-footer",section:document.getElementById("main-cart-footer").dataset.id,selector:".js-contents"}]}updateQuantity(e,t,a){this.enableLoading(e);const o=JSON.stringify({line:e,quantity:t,sections:this.getSectionsToRender().map(r=>r.section),sections_url:window.location.pathname});fetch(`${routes.cart_change_url}`,{...fetchConfig(),body:o}).then(r=>r.text()).then(r=>{const s=JSON.parse(r);this.classList.toggle("is-empty",s.item_count===0);const n=document.querySelector("cart-drawer"),d=document.getElementById("main-cart-footer");d&&d.classList.toggle("is-empty",s.item_count===0),n&&n.classList.toggle("is-empty",s.item_count===0),this.getSectionsToRender().forEach(i=>{const u=document.getElementById(i.id).querySelector(i.selector)||document.getElementById(i.id);u.innerHTML=this.getSectionInnerHTML(s.sections[i.section],i.selector)}),this.updateLiveRegions(e,s.item_count);const c=document.getElementById(`CartItem-${e}`)||document.getElementById(`CartDrawer-Item-${e}`);c&&c.querySelector(`[name="${a}"]`)?n?trapFocus(n,c.querySelector(`[name="${a}"]`)):c.querySelector(`[name="${a}"]`).focus():s.item_count===0&&n?trapFocus(n.querySelector(".drawer__inner-empty"),n.querySelector("a")):document.querySelector(".cart-item")&&n&&trapFocus(n,document.querySelector(".cart-item__name")),this.disableLoading()}).catch(()=>{this.querySelectorAll(".loading-overlay").forEach(s=>s.classList.add("hidden"));const r=document.getElementById("cart-errors")||document.getElementById("CartDrawer-CartErrors");r.textContent=window.cartStrings.error,this.disableLoading()})}updateLiveRegions(e,t){if(this.currentItemCount===t){const o=document.getElementById(`Line-item-error-${e}`)||document.getElementById(`CartDrawer-LineItemError-${e}`),r=document.getElementById(`Quantity-${e}`)||document.getElementById(`Drawer-quantity-${e}`);o.querySelector(".cart-item__error-text").innerHTML=window.cartStrings.quantityError.replace("[quantity]",r.value)}this.currentItemCount=t,this.lineItemStatusElement.setAttribute("aria-hidden",!0);const a=document.getElementById("cart-live-region-text")||document.getElementById("CartDrawer-LiveRegionText");a.setAttribute("aria-hidden",!1),setTimeout(()=>{a.setAttribute("aria-hidden",!0)},1e3)}getSectionInnerHTML(e,t){return new DOMParser().parseFromString(e,"text/html").querySelector(t).innerHTML}enableLoading(e){(document.getElementById("main-cart-items")||document.getElementById("CartDrawer-CartItems")).classList.add("cart__items--disabled");const a=this.querySelectorAll(`#CartItem-${e} .loading-overlay`),o=this.querySelectorAll(`#CartDrawer-Item-${e} .loading-overlay`);[...a,...o].forEach(r=>r.classList.remove("hidden")),document.activeElement.blur(),this.lineItemStatusElement.setAttribute("aria-hidden",!1)}disableLoading(){(document.getElementById("main-cart-items")||document.getElementById("CartDrawer-CartItems")).classList.remove("cart__items--disabled")}}customElements.define("cart-items",g);customElements.get("cart-note")||customElements.define("cart-note",class extends HTMLElement{constructor(){super(),this.addEventListener("change",debounce(e=>{const t=JSON.stringify({note:e.target.value});fetch(`${routes.cart_update_url}`,{...fetchConfig(),body:t})},300))}});
